labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
emm2 <- emmeans(mdf.m1, pairwise~Density, CIs = T, type = 'response', adjust = 'tukey')
data2 <- multcomp::cld(emm2, alpha = 0.1, Letters = letters)
ggplot(data = data2, aes(x = Density, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Density", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggsave("model_means_density_fb.jpeg")
ggplot(data = data1, aes(x = Group, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggsave("model_means_seeded_fb.jpeg")
glimpse(ul)
load("clean_dfs.RData")
library(tidyverse)
library(glmmTMB) #allows us to use a beta distribution
library(DHARMa)
library(emmeans)
library(car)
library(multcompView)
library(gridExtra)
library(multcomp)
options(contrasts = c("contr.sum", "contr.poly"))
fb$Group <- as.factor(fb$Group)
fb$Density <- as.factor(fb$Density)
ul$Group <- as.factor(ul$Group)
ul$Density <- as.factor(ul$Density)
#only need the last date
mdf <- fb %>%
filter(Date == "2022-09-16") %>%
select(Block, Group, Density, Date, Invasive.Cover, Native.Cover)
useData <- filter(mdf, Density != "C") #to make the plotResiduals work
useData$Group <- factor(useData$Group)
useData$Density <- factor(useData$Density)
##FB Native ####
mdf.m1 <- glmmTMB(Native.Cover ~ Group * Density #* for interaction
+ (1|Block),
data = useData,
family = beta_family, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
emmeans(mdf.m1, pairwise~Group) #not significant when adjusted for the tukey test
emmeans(mdf.m1, pairwise~Group, adjust = "none") #a more liberal test shows what we expected above with the groups
emmeans(mdf.m1, pairwise~Group) #not significant when adjusted for the tukey test
##FB Invasive trt vs ctl ####
mdf$gd <- factor(mdf$Group:mdf$Density) #compares every combination of treatment and control
mdf.m2 <- glmmTMB(Invasive.Cover ~ gd #* for interaction
+ (1|Block),
data = mdf,
family = beta_family, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
#Dunnetts test - type 1 error control, comparing the control to each of 10 other means
#We have inflated type 1 error because we use the control mean 10 times
#We could use a tukeys but that would control for 55 tests and we only need 10 - we will lose all power
#Allows us to just look at control against every other treatment - only the comparisons we want
emmeans(mdf.m2, specs = trt.vs.ctrlk~gd,ref = 3, type = "response") #reference group is the third option (10:C)
#there is some suggestion that there might be some differences but the study fails to support these differences - suggestion without support
emm1 <- emmeans(mdf.m1, pairwise~Group, CIs = T, type = 'response', adjust = 'tukey')
data1 <- multcomp::cld(emm1, alpha = 0.1, Letters = letters)
ggplot(data = data1, aes(x = Group, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggsave("model_means_total_fb.jpeg")
emm2 <- emmeans(mdf.m2, specs = trt.vs.ctrlk~gd,ref = 3, type = "response")
data2 <- multcomp::cld(emm2, alpha = 0.1, Letters = letters)
ggplot(data = data2, aes(x = Group, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
View(data2)
ggplot(data = data2, aes(x = gd, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ata2
data2
#Dunnetts test - type 1 error control, comparing the control to each of 10 other means
#We have inflated type 1 error because we use the control mean 10 times
#We could use a tukeys but that would control for 55 tests and we only need 10 - we will lose all power
#Allows us to just look at control against every other treatment - only the comparisons we want
emmeans(mdf.m2, specs = trt.vs.ctrlk~gd,ref = 3, type = "response") #reference group is the third option (10:C)
emm2 <- emmeans(mdf.m2, specs = trt.vs.ctrlk~gd,ref = 3, type = "response", adjust = 'tukey')
data2 <- multcomp::cld(emm2, alpha = 0.1, Letters = letters)
ggplot(data = data2, aes(x = gd, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
##FB Invasive trt vs ctl ####
mdf$gd <- factor(mdf$Group:mdf$Density) #compares every combination of treatment and control
mdf.m2 <- glmmTMB(Invasive.Cover ~ gd #* for interaction
+ (1|Block),
data = mdf,
family = beta_family, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
summary(mdf.m2) #don't use this summary
#Dunnetts test - type 1 error control, comparing the control to each of 10 other means
#We have inflated type 1 error because we use the control mean 10 times
#We could use a tukeys but that would control for 55 tests and we only need 10 - we will lose all power
#Allows us to just look at control against every other treatment - only the comparisons we want
emmeans(mdf.m2, specs = trt.vs.ctrlk~gd,ref = 3, type = "response") #reference group is the third option (10:C)
emm2 <- emmeans(mdf.m2, specs = trt.vs.ctrlk~gd,ref = 3, type = "response", adjust = 'tukey')
data2 <- multcomp::cld(emm2, alpha = 0.1, Letters = letters)
ggplot(data = data2, aes(x = gd, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
emm2
data2
emm1
data1
emm2
data2
##FB native trt vs ctl ####
mdf$gd <- factor(mdf$Group:mdf$Density)
mdf.m3 <- glmmTMB(Native.Cover ~ gd #* for interaction
+ (1|Block),
data = mdf,
family = gaussian, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
emmeans(mdf.m3, specs = trt.vs.ctrlk~gd,ref = 3, type = "response") #reference group is the third option (10:C)
emm3 <- emmeans(mdf.m3, specs = trt.vs.ctrlk~gd,ref = 3, type = "response", adjust = 'tukey')
data3 <- multcomp::cld(emm3, alpha = 0.1, Letters = letters)
ggplot(data = data3, aes(x = gd, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
data3
ggplot(data = data3, aes(x = gd, y = emmean * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggplot(data = data3, aes(x = gd, y = emmean * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(emmean - SE),
ymax = 100*(emmean+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = emmean * 100),
nudge_x = 0.2)
ggsave("model_means_dunnett_fb.jpeg")
emm2 <- emmeans(mdf.m2, specs = trt.vs.ctrlk~gd,ref = 3, type = "response", adjust = 'tukey')
data2 <- multcomp::cld(emm2, alpha = 0.1, Letters = letters)
data2
ggplot(data = data2, aes(x = gd, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
emm2
ggplot(data = data2, aes(x = gd, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggplot(data = data1, aes(x = Group, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggsave("model_means_total_native_fb.jpeg")
ggplot(data = data2, aes(x = gd, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggsave("model_means_dunnett_invasive_fb.jpeg")
ggplot(data = data3, aes(x = gd, y = emmean * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(emmean - SE),
ymax = 100*(emmean+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = emmean * 100),
nudge_x = 0.2)
ggsave("model_means_dunnett_native_fb.jpeg")
##FB Invasive ####
mdf.m4 <- glmmTMB(Invasive.Cover ~ Group * Density #* for interaction
+ (1|Block),
data = useData,
family = beta_family, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
emm4a <- emmeans(mdf.m4, pairwise~Group, type = "response", adjust = 'tukey')
data4a <- multcomp::cld(emm4a, alpha = 0.1, Letters = letters)
data4a
ggplot(data = data4a, aes(x = Group, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
##FB Invasive ####
mdf.m4 <- glmmTMB(Invasive.Cover ~ Group * Density #* for interaction
+ (1|Block),
data = useData,
family = beta_family, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
summary(mdf.m4)
simulateResiduals(mdf.m4, plot = T)
emmip(mdf.m4, Group~Density, CIs = T) #looks significant without CI but the CI shows it isn't
car::Anova(mdf.m4) #no interaction but densities different and at least one group different
emmip(mdf.m4, Group~Density, CIs = T, type = "response") #shows on the level of the response
emmeans(mdf.m4, pairwise~Group) #only 4 and 5 different when adjusted for tukey
emmeans(mdf.m4, pairwise~Group, adjust = "none") #same as with the tukey
emmeans(mdf.m4, pairwise~Group, type = "response") #only 4 and 5 different when adjusted for tukey
emmeans(mdf.m4, pairwise~Group, adjust = "none", type = "response") #same as with the tukey
ggplot(data = data4a, aes(x = Group, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggsave("model_means_total_invasive_fb.jpeg")
ggsave("model_means_total_invasive_fb_mix.jpeg")
emm4b <- emmeans(mdf.m4, pairwise~Density, type = "response", adjust = 'tukey')
data4b <- multcomp::cld(emm4b, alpha = 0.1, Letters = letters)
ggplot(data = data4b, aes(x = Density, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
emmeans(mdf.m4, pairwise~Density) #not significant but almost significant when adjusted for with tukey
emmeans(mdf.m4, pairwise~Density, type = "response") #not significant but almost significant when adjusted for with tukey
ggplot(data = data4b, aes(x = Density, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggsave("model_means_total_invasive_fb_density.jpeg")
#UL ####
mdf1 <- ul %>%
filter(Date == "2022-09-16")
useData <- filter(mdf1, Density != "C") #to make the plotResiduals work
useData$Group <- factor(useData$Group)
useData$Density <- factor(useData$Density)
##UL Invasive trt vs ctl ####
mdf1$gd <- factor(mdf1$Group:mdf1$Density) #compares every combination of treatment and control
mdf.m5 <- glmmTMB(Invasive.Cover ~ gd #* for interaction
+ (1|Block),
data = mdf1,
family = beta_family, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
emmeans(mdf.m5, specs = trt.vs.ctrlk~gd,ref = 3) #reference group is the third option (10:C)
emm5 <- emmeans(mdf.m5, pairwise~Group, type = "response", adjust = 'tukey')
emm5 <- emmeans(mdf.m5, specs = trt.vs.ctrlk~gd,ref = 3, type = "response", adjust = 'tukey')
data5 <- multcomp::cld(emm5, alpha = 0.1, Letters = letters)
ggplot(data = data4a, aes(x = Group, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggplot(data = data5, aes(x = Group, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
data5
ggplot(data = data5, aes(x = gd, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggsave("model_means_dunnetts_invasive_ul.jpeg")
##UL Invasive ####
mdf.m6 <- glmmTMB(Invasive.Cover ~ Group * Density #* for interaction
+ (1|Block),
data = useData,
family = beta_family, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
##UL Invasive ####
mdf.m6 <- glmmTMB(Invasive.Cover ~ Group * Density #* for interaction
+ (1|Block),
data = useData,
family = beta_family, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
emm6 <- emmeans(mdf.m6, pairwise~Group, type = "response", adjust = 'tukey')
data6 <- multcomp::cld(emm6, alpha = 0.1, Letters = letters)
ggplot(data = data6, aes(x = Group, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggplot(data = data3, aes(x = gd, y = emmean * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(emmean - SE),
ymax = 100*(emmean+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = emmean * 100),
nudge_x = 0.2)
##FB Invasive ####
mdf.m4 <- glmmTMB(Invasive.Cover ~ Group * Density #* for interaction
+ (1|Block),
data = useData,
family = beta_family, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
emm4a <- emmeans(mdf.m4, pairwise~Group, type = "response", adjust = 'tukey')
data4a <- multcomp::cld(emm4a, alpha = 0.1, Letters = letters)
ggplot(data = data4a, aes(x = Group, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
##FB Invasive ####
mdf.m4 <- glmmTMB(Invasive.Cover ~ Group * Density #* for interaction
+ (1|Block),
data = useData,
family = beta_family, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
summary(mdf.m4)
load("clean_dfs.RData")
library(tidyverse)
library(glmmTMB) #allows us to use a beta distribution
library(DHARMa)
library(emmeans)
library(car)
library(multcompView)
library(gridExtra)
library(multcomp)
options(contrasts = c("contr.sum", "contr.poly"))
fb$Group <- as.factor(fb$Group)
fb$Density <- as.factor(fb$Density)
ul$Group <- as.factor(ul$Group)
ul$Density <- as.factor(ul$Density)
#only need the last date
mdf <- fb %>%
filter(Date == "2022-09-16") %>%
select(Block, Group, Density, Date, Invasive.Cover, Native.Cover)
useData <- filter(mdf, Density != "C") #to make the plotResiduals work
useData$Group <- factor(useData$Group)
useData$Density <- factor(useData$Density)
##FB Native ####
mdf.m1 <- glmmTMB(Native.Cover ~ Group * Density #* for interaction
+ (1|Block),
data = useData,
family = beta_family, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
load("clean_dfs.RData")
library(tidyverse)
library(glmmTMB) #allows us to use a beta distribution
library(DHARMa)
library(emmeans)
library(car)
library(multcompView)
library(gridExtra)
library(multcomp)
options(contrasts = c("contr.sum", "contr.poly"))
fb$Group <- as.factor(fb$Group)
fb$Density <- as.factor(fb$Density)
ul$Group <- as.factor(ul$Group)
ul$Density <- as.factor(ul$Density)
#only need the last date
mdf <- fb %>%
filter(Date == "2022-09-16") %>%
select(Block, Group, Density, Date, Invasive.Cover, Native.Cover)
#only need the last date
mdf <- fb %>%
filter(Date == "2022-09-16") %>%
tidyverse::select(Block, Group, Density, Date, Invasive.Cover, Native.Cover)
#only need the last date
mdf <- fb %>%
filter(Date == "2022-09-16") %>%
dplyr::select(Block, Group, Density, Date, Invasive.Cover, Native.Cover)
useData <- filter(mdf, Density != "C") #to make the plotResiduals work
useData$Group <- factor(useData$Group)
useData$Density <- factor(useData$Density)
##FB Native ####
mdf.m1 <- glmmTMB(Native.Cover ~ Group * Density #* for interaction
+ (1|Block),
data = useData,
family = beta_family, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
summary(mdf.m1) #don't use this summary
car::Anova(mdf.m1) #no interaction but at least one group different from another
emmip(mdf.m1, Group~Density, CIs = T, type = "response") #shows on the level of the response
emmeans(mdf.m1, pairwise~Group) #not significant when adjusted for the tukey test
##FB Invasive ####
mdf.m4 <- glmmTMB(Invasive.Cover ~ Group * Density #* for interaction
+ (1|Block),
data = useData,
family = beta_family, #because cover
control = glmmTMBControl(optimizer = optim,
optArgs = list(method="BFGS"))
)
summary(mdf.m4)
simulateResiduals(mdf.m4, plot = T)
plotResiduals(mdf.m4, form= useData$Density)
emmip(mdf.m4, Group~Density, CIs = T) #looks significant without CI but the CI shows it isn't
car::Anova(mdf.m4) #no interaction but densities different and at least one group different
emm4a <- emmeans(mdf.m4, pairwise~Group, type = "response", adjust = 'tukey')
data4a <- multcomp::cld(emm4a, alpha = 0.1, Letters = letters)
ggplot(data = data4a, aes(x = Group, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggsave("model_means_total_invasive_fb_mix.jpeg")
emm4b <- emmeans(mdf.m4, pairwise~Density, type = "response", adjust = 'tukey')
data4b <- multcomp::cld(emm4b, alpha = 0.1, Letters = letters)
ggplot(data = data4b, aes(x = Density, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Seed Mix", y = "Model predicted percent cover") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.2)
ggsave("model_means_total_invasive_fb_density.jpeg")
